you hello in this bonus stream time today we will open the gift books next present this is made by Marty he gave this to me as the Christmas present the observatory he made this as a side level for RTYI and it looks pretty nice he's the leader of the bunch you know him well he's finally back the can't stop him his coconut gun can fire exports if he shoots ya it's gonna hurt he's bigger, faster and stronger He's the first member he's the first member he's the first member Peaches he's the first member do not jump off triangle you told me when you started, I always started too by the way you didn't miss anything I literally just started so I guess this is overhead camera alright nice nice nice he has no style he has no grace he can lift this car ok so these are platforms that move out with the switch I really like the way the waterfall looks here like it's such a cool effect I can make some water splashes here like particles so I think this was the rolling boulders right? yeah staircases this reminds me of Sonic Adventure's casino level oh the light looks really good too I can add real light sources here so Mario lights up we got art on the walls faucet fake door ship and then you were thinking like an easter coin here somewhere over here staircase has the slope hidden under oh right so this is supposed to go up like this right? there is one change I'm thinking of making to the staircase and it's a very small change let me just show you so for staircases like this I like to make the inner part a little darker I think it makes the front part pop a little more you know what I mean? not completely black but like close to it what do you think? you think about CoopDX? I don't think about CoopDX make that under texture oh that doesn't need to be baked under the texture or is this like a seamless transition somehow that I just ruined I see oh why don't you use CoopDX? why the fuck would I use CoopDX? give me one reason anyway we're not here to talk about CoopDX 11.544 triangles oh my god wait why would I double that? why does vertex coloring double the tricount? where is this coming from? hello PochiGamer yep I had a decent Christmas I liked it someone got a table tennis set and we play table tennis a lot and I like table tennis oh no no no I wasn't gonna split it in the middle I was just gonna leave it the way it is now I just made the inner side a little darker I made these two vertices darker so that the front part pops a little more it's a very minor change this probably needs some back face coloring off oh I see so we agree on the change that's awesome man my blender is being really laggy for the background it's actually cheaper to cut out the outer part like that which is why I am going to do that if you haven't subscribed to my channel yet this is what it looks like for the bit no it's going to crash my PC I can't make cottages of the game Pochi that would get me in legal trouble with Nintendo so the skybox actually cannot be part of the level it's going to be like an infinitely far one so at first we will import this without the skybox but then we'll get the skybox filter so let's get an import going I would say this has 11,544 triangles which means that we cannot import the collision here collision wise this is going to be too expensive so I'm going to have to make a duplicate of this and get rid of some triangles for the collision only so wait everything down here is just not something you interact with you can go there but there is nothing to do there I have to think about something to put here I mean it's kind of cool that we have a liminal kind of useless type space where you can just go and experience the world I do like that a lot oh yeah don't worry I know what I'm deleting oh we have the same thing going on that biobank is going on with the useless primitive color alpha here interesting that really is just a thing fast64 does to screw you over isn't it kind of funky oh this is a decal to cubemap the edges why is this a decal though wouldn't it just work as not a decal like so oh wait nevermind I see why it is a decal now so these I assume are going to be 3d models in the end oh that's just a genuine transition okay oh I see this is a material that blends two colors it's definitely visual only damn there's still a shit ton of decals I haven't deleted and it's not this one wait oh oh that's it no okay we can't do that this is actually impossible to do you have a decal on the floor without anything underneath so that is not going to render okay so I will need to make a duplicate of your material that has no decal setting unfortunately yeah don't worry easy fix oh I see yeah I looked at that and I was like wow a very saturated color for them all being the same material I looked at them and I was under the impression they are all different materials but no I see you Biobank hello sparklingzone welcome to the stream so this one is also supposed to be something else I assume like a 3D model in the end there's another background baked into the whole map yes it's pretty neat isn't it there's another background baked into the whole map yes it's pretty neat isn't it oh something's up with the trees what happened here they look like they are all the wrong way around is this collision only or it's a visual yeah also these are transparent it's not going to work as transparent unfortunately I have to make them alpha cutouts this is because of draw order shenanigans that you would not necessarily see in blender but they still look fine though R.T.Y.I. R.T.Y.I. will not feature scrupulous finger okay oh yeah transparent decal on this definitely doesn't work don't worry though we will figure it out this is nothing compared to the fixes I had to do on zaina's model yesterday right so we need to duplicate the path grass so what wait did I just change all of them no easy way to detect where they should not be looks good I would say oh also we can get rid of these triangles that's right oh we can't nevermind okay okay I think we got that back to the collision this one oh actually that one doesn't have anything oh we're also on the wrong microcode right right but I was talking about visual right now what is this triangle is that on purpose oh I see it is on purpose it's for the water famousrosen you just have chat it's a fight maybe okay I somehow destroyed this that's concerning I feel like the little bamboo here it would be better if mario couldn't interact with this just for the sake of not getting stuck on weird stuff oh we still have a concerning amount of triangles in the collision map and I will need to reduce that somehow maybe these trees shouldn't be interactable either yeah what if I have an idea we make these un-interactable we make these un-interactable and then we do that and then then what the hell is this wait what is this can that go what is this on the visual map oh it's like a darkening of the path I see many triangles is this only a hundred okay that can probably stay on the visual map then can you just make the bamboo not have collision or does it need to be interactive for that I can just make it not have collision and that's exactly what I did I don't have too many too many what, what are we talking about right now it looks very good what this will be used for in the egg it's a side level martin just made this I feel like we shouldn't be removing these windows because it looks like Mara can walk into there 9500 still what if we do M and then D there's still 400 triangles from decals somehow that I am not seeing right now I don't know probably should have finished with this first did I just find some useless ones oh shit this looks like relatively useless triangles and these are transparent decals as well it's going to look wrong in the source map or in the visual map hmm need a solution for that probably just going to do that did I fuck it up why is this duplicated I'm confused oh okay I'm still confused wait this shouldn't be duplicated right oh I think everything's single objective you can separate things into objects but that's very impractical for when you're actually working with the level because it makes editing everything more difficult but also your bottleneck is basically always memory throughput so you only want to separate things into a separate object if they can be culled during the laggiest view the laggiest view is probably going to be something like this so we're probably going to separate this tower here into a separate one maybe this maybe the fence here into the same as the tower and then this one here is going to be culled separately but that's about it more separation than that would just make the game slower an aqueduct? no oh yeah this is definitely not what this is supposed to look like that looks a lot closer grass overhang grass overhang did I not already delete that? sorry where am I missing the grass overhang oh that was the visual map I hope I'm not f***ing it up this is the visual map right now I don't know why did I destroy the grass overhang? did I destroy anything in the visual map? is that where the confusion comes from? I hope I didn't confusion, okay nice yeah I get it, I sometimes confuse myself I go very fast with these things okay okay this button looks very good but unfortunately I think it's not on the nose enough so we will need the stupid pink rubber mario button unfortunately I'm sorry to say it 9292 aha more decals over here oh we have the same issue again of the decal also being the floor texture shit okay we need another duplicate material here okay unfortunately I'm going to let you know I'm not going to use the pretty one I'm just going to use the mario 64 button this is not because I think yours is ugly or anything, this is just because like design language I guess yeah okay okay nice I am glad to not have insulted you okay it would be a shame if I ruined something that you liked a lot after you spent so much time on this and then you'd be upset oh this one's surprising how come there's two triangles here or two quads rather is this from vertex colors or something does this need to be here duplicate for fading okay fair enough what is this line oh doesn't seem to affect anything another line like this doesn't affect anything either interesting I don't care for achten oh we never want to use environment color alpha that's going to randomly bug out easy fix still 9100 triangles in the collision map there's still so many overlaps here somehow what is this wait why is there a duplicate actually here what's this for does this have a reason this seems a little wasteful I guess these borders shouldn't be interactable oh I see okay that's a lot I can remove and that makes sense see your first line why does this not work what the hell your blender file is weird can't do the rectangular selection oh oh let's do it like this then deleting too far oh fuck okay I see I see now I see my mistake you only want it gone until here okay that should definitely make the collision map small enough I want it like so so that people don't go behind here that's why I'm cutting off slightly more there this selection tool is weird in this file hmm according to your screenshot people should be able to jump down here but wouldn't it be weird if they can't jump down here but they can jump down here I guess it kinda makes sense because of the fence okay we'll keep this intact then because of the fence but it does feel a little inconsistent let's see if this causes issues I guess alright we're down to 8800 on the collision map there's still 300 decal surfaces somewhere that I'm not seeing oh wait it's these duplicate ones I see they might not be decals then I might have to start actually like doing the small bits of collision now so we probably also don't want the player to go in here I would think probably do that oh maybe we need that here just because I don't want there to be a giant collision all around here like are you fixed? that's why you can remove so much this is the collision map yeah hmm okay 2800 is still a lot for a collision map I guess this is cut off so hmm can't do that still 8800 of course but before that I'd like to do all the simple saves just so I can get a first import done I don't want to get into like doing all the small details until we actually have the map in a state where we are fully happy with it I also for example don't do any collision mapping before biomextreme works honestly I think this might be simple enough to work access aligned assets? oh I see that's different and now the scaling you said you had Mario somewhere? the size of Mario? where is the size of Mario? is it Mario reference? okay so a triple jump here is 5.1 and the normal height is 0.64 so your scale is around 25 times or 250 times what I usually do 250 divided by 0.64 232 times less than I would usually do okay I'm gonna scale your entire map up to accommodate for that now it's at my normal size hello Xlinks I'm glad you like it it's Marty's level 9 months of work he gave birth to a new level 9 months of work he gave birth to a new level 9 months of work he gave birth to a new level 9 months of work he gave birth to a new level 9 months of work he gave birth to a new level the grass wind waves oh is it this part here? do I have to make this texture move? do I have to make this texture move? wait oh it is this texture has to move ok I see alright we can look into that scroll texture 1 wait scroll texture 1 is going to be a little hard to find yeah don't worry it probably has to go in the sine wave pattern anyway it probably has to go in the sine wave pattern anyway so the fast64 setup is not going to work very well so the fast64 setup is not going to work very well our next step is making a new level our next step is making a new level wait wait wait wait wait wait wait wait wait wait wait wait wait wait wait wait let's see wait let's see let's see let's see let's see let's see ok ok ok ok ok ok ok ok ok ok ok  ok ok ok ok ok by by ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok ok so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so so observatory entry and out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out out . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . Dude this is actually gonna be so fun to explore with all these little niches to go into. This has a strong Mario is a hamster on the loose feeling to me. This definitely needs some back face cutting removed. This is a little bit awkward to move up on. I know you initially wanted Mario to like look through this but I think the collision on this is just so small that we can't reasonably do that. I think this whole thing just has to be like a big solid blob of collision that you can't interact with. Unfortunately. Are we supposed to be smaller here? Did I make the level too small? Was the level supposed to be bigger? Let's yeah let's change the back face cutting on let's go. Hmm so I guess Mario is supposed to be a lot bigger but not by a whole lot. How about we make him 20% bigger 20% bigger. Design this level Marty. I only gave him a little bit of feedback. Let's see how it feels 20% bigger. This beginning area feels significantly worse than 20% bigger to me. But this area feels very good. Hmm I should figure out what that bug is that's the first time I've seen it. It is very hard to get the scaling right without having the game right in front of you. Not sure if you were able to export the level yourself or not. I kind of want to make it just a little bit smaller again. The scaling on this is still too small for this to reasonably be an end gameplay element to interact with. I think I want to reduce the scaling by 10% again. I guess we're gonna look like that because there's no background yet. I think the catwalk is wrong. Yeah the catwalk has the most significant issue. Can we maybe simplify the catwalk in a way where Mario can reasonably interact with it Yeah. Like so. All right, so you're okay with me just making some modifications here to simplify this? That is good. I'll move this whole thing down a little bit then. It needs that as well. Oh, that's unfortunate. We'll do something like this so Mario can conceivably stand in front of it. Oh, this is two textures. Let's see how this works now. I like the Sonic level. Sonic level? It has a lot of new textures and objects, grass, mounds, hills, hedges. Isn't this going to stand out in the final game? I think each level has a lot of new textures. Don't you think? Hello, Guinness. What happened to my Donkey Kong music? That was weird. Do you think it has too many new textures? I mean, ideally you would think that every texture uses a new texture. Then there's also these where I wanted to just kind of darken the bottom part a little bit. This always looks very good when you do that. How would that be received? People would think that's very cool. Oh, no, I don't do that. I do have a large texture collection and I do often reuse textures, but that's just a limitation of me as a person. Let's add the background. That looks like Spyro. Marty has a very Spyro-style. I think that's what makes this level look different, if anything. It looks like Hillside Grass Trees. I use the same textures all the time. I feel like I'm being part of the same world. Sometimes they do. Sometimes we intentionally do that. And yeah, sometimes the overworld has the same textures as the level around it. Yes, so the skybox is really far away, right? But obviously the N64 cannot draw things far away at any amount of reasonable precision. So we draw it first with no depth at all. And then it works. We draw it much smaller. We just move it around the camera. Something like this. What a nice song. The clouds can indeed be animated to do that. This render order looks fine. Then they all need no Z-buffer, please. That's what I wanted. Hello, Lilo. All right. Then lastly, the clouds. All the Z-buffers off. And now we can export this. Level data. Custom. Don't we have an all headers file? Why am I not just including that there? This is silly. Already set to 99%. That'd be good. I can close this now. Let me save this in the right spot so I don't lose it. 6. Time to export. Hello, BongPosting. Doesn't matter if I use a lot of indexed color textures anyway. There just has to be something to save a little bit of from, since we're using the same texture with different color palettes. I mean, on one hand, sure. But, like, you would have to set up the infrastructure in your game to share single texture files like that between levels. And I have not. There's a lot of textures that would be stored, could we get them to run much slower? No backgrounds? Where's my backgrounds? Hmm. Where's the rotation node and where is my geo assembly? Oh, I added it to the collision like an idiot. Yeah, but there's two issues here. Or one issue that we need to fix. That is, we need to apply all the transforms. So the whole visual model was being rotated by 90 degrees, which obviously is an issue. And now the infpg is hooked up. Now we should have the background in. I have seen the PS1 Mario 64, yes. Hey! How's that looking? The green is going a lot higher than I think we want it to go. I don't think it's supposed to look like that, right? I think we have to move the whole skybox down a fair bit. Yeah, let's move the skybox down. So what does this count? Also while we're here, let's take a look at this material here being wrong. What is going on here? Oh, I bet it's this one here. Minus two and minus three is what you want. You had the mask set too high, that's why. Does it fit in the rest of the game? This is my first time seeing it. Do you remember how there is goldfish in the overworld? And you save the goldfish. And then the goldfish gives you a secret. And if you do that secret, you open a secret level. This is the secret level you get. That looks closer to what Marty wants, I think. Yeah! Other levels looking good. There is one issue here on the side of the mountain that you can look through it. And I need to fix the collision here. Can you try this on the N64? That is going to be the next step after we fix the visual bugs here. It's not going to be much longer until we test on the N64. It is 11,000 triangles, so it might not do too well on the N64. I definitely want to check it out. I'm going to try it on the N64. Well, culling isn't free either, so... We can't just cull everything and then be like, it's culled, so it doesn't cost anything. Oh, interesting. Oh! Garden soil decal? I see. Do you mind if I just swap this out for a different material? Like, what if I just kinda do that? And change the color of this a little bit? So I don't have to add a second material for that again. It's going to be a fair bit cheaper. It doesn't really look any different. Okay, nice. I also just realized I missed this stump when I did my stump coloring. And I don't like that the stump is so much in the floor. That's going to waste a lot of overlap for no reason and get some Z-fighting going. So let me just move him onto the floor. So remember this area on the N64 as of now? We haven't tested it yet, but we're very close to just testing it. Because we're basically done fixing the visual bugs now. So you see this file has 16,752 triangles. I think the level is like 12,000 now with the background. Yeah, you didn't know of snapping? You just turn on snapping and then you do a two triangle. And that will snap it to the floor. Alright, uploading it to my N64. Switching to the N64. Is it cheaper to have geometry passing inside another or some extra vertex to probably connect the geometries? It's usually cheaper to just have them pass through. But it depends on the context. Please excuse me playing with a lot of input lag. Okay, 29 FPS, 27, 34. So we should check the laggiest configuration we can think of here. Which is probably standing in this corner here. And then looking at the whole level. Without hiding Mario. Maybe first person is laggier. Okay, so the laggiest we can get is like 25 FPS. This is without any culling by the way. This is literally just crunching 12,000 triangles. It is toilet duck and I think this is proof of that. But yeah, the N64 can just look like this. I have so much input lag, let me get up. Notice to some rare people, we didn't even add culling. This is actually super unoptimized still. Yes, we can make Mario darker in the cliff shadow. Oh, this scene has relatively low FPS. That's an issue, because that's platforming. So what's probably happening here is that everything below Mario is being drawn first. And then we overdraw it with the cliff. So we probably have to change the material order and then we're going to gain like 5 FPS here. Can you see the occlusion plane thing? The big pillar in the middle of the map to count stuff behind it? That seems like a good place for it. Yes, we can. So before we do any optimization though, we need to know what the laggiest place is so we can improve it. What is PVS? Is that a legma? That's a legma. Oh, potential visibility scene. No, we don't have that. There's a lot of culling algorithms you can add and a lot of them is a lot of data crunching. And it's usually just worse than just rendering the level. Oh, this is our laggiest scene. Oh, this one hits 19. Which I guess you're not really supposed to be here anyway, but still. It kind of makes sense, right? Because all the polygons are in the scene at once. And we have the big overdraw from the bridge here. I can turn on the other ring if you guys want the ring off. I can turn on anti-aliasing in this end widescreen. And that's going to be even more laggy. 16 is our absolute laggiest setting. I can't play with this input lag. It's like I have to do an input and then like two seconds later it happens. I want you guys to appreciate how hard I'm playing here. But this part is still fine at widescreen with every effect on it possible. Back to my face. I'm using all the image on that bridge and I'm redrawing pixels multiple times here. You expected worse? Nah, my engine is awesome. So the obvious improvement is a big culling plane. Well, actually we have decided. Which view do we want to make less laggy now? There is a depth buffer. It will be the added cost of enemies, but it ain't much against your basic culling planes. Enemies is not something we have to worry about. The target is 30 with anti-aliasing on ideally. But of course that's very difficult to do if you have levels as complex as this. Why does it lag here? Because you're drawing all the polygons and you're overdrawing with the bridge. So we have one section that was kinda laggy. You can sort mesh elements, which will change the draw order of things. Which is going to make stuff render faster. So for example the dirt path here, we want it to render above the grass. So we move this at the very top. Now it's going to render above these things here. And that's fine to not render above anything. And then the bridge here, it renders basically last right now. You see how this renders last? So if we also move this at the very very first, that one section is going to lag a lot less. Remove this one as well. And this one as well. Yo, thank you for the gift subs! I'm sorry if I'm bad streamer and I don't hear them. I'm sorry for everyone who donated and I missed it. It's very difficult for me to hear them for some reason. But it's the exact same as it was supposed to be. It's someone's astro-observatory, where it's like a garden and stuff. And there's going to be magical appliances that protect this garden. Let's give it another N64 test, see what we've improved. Let's put it at 30 FPS with anti-aliasing on, so you guys have a better view of what the final player is going to see when they play this video game. Summercart.bat. It's a batch file that uploads everything to the summer cart. So this is pretty much the intention. And okay, the beginning is 25 FPS with anti-aliasing on. Which of course is an issue. But don't worry, we still have culling and stuff. So I assume that looking at the mountain would cause more lag. No, it's not easier to test than hardware, it's only possible to test than hardware. How are you going to test performance outside of hardware? This all seems good except for the very beginning of the stage. Yes, this is V-Synced. See, on the N64 you basically have two viable options. The first is you triple buffer and V-Sync. The other is you double buffer and you V-Sync. And if you double buffer and V-Sync and you ever drop below 30, you're in 20. Okay, so this section is still pretty laggy. I think this should be our number one priority. Improving this spot here. This spot is important to run well because this is going to be platforming. So if you have lag here and you die to that, it's going to be very bad. The input lag is from a capture card. Are you skipping input reading to achieve better FPS? Do you see me play Mario 64 right now? Do you think Mario would move if my inputs were not being read? Come on. The AA hides the dithering? I don't know. Not on purpose. What's the input lag with V-Sync on a console? You have 67 milliseconds of input lag. It's just part of the game. You see this in every N64 game. In something like Zelda, it's even like 100 milliseconds because the game is 20 FPS. Okay, so the top also has a little bit of lag here. So there's two parts that are kind of laggy. The top part and that one part at the waterfall. I think this is going to be a little bit difficult to see. Marty, I think we should have the star just be right in front of here. Like here. Or maybe where the observatory would be. Because I don't think people are going to be here and try to interact with this. Unless we had a sparkle and you went in there and Mario automatically entered first person or something. So there are more polygons to read off your pixel without those arches bridge area? No. Well, it could help, but unlikely. It would also make the other settings way worse. Also keep in mind, we have now Z-sorted this. So now it's still 19 FPS. But if we turn off the aliasing, I'm sure it would be better than it was before. Yeah, we gained like 1.5 FPS here. I am using the Cloner Alliance capture card. So for this archway, we kind of have two options. The first is to make this inaccessible. So that players wouldn't go over there. Which I think is the correct option. We can just make this actually very slippery. So that it's unreasonable to get over there. And the other is to fuck ourselves over and try to make this not laggy. Which I think is the worst option. Star shouldn't appear from the sky and fall to the tippy part of the hill. Oh, I see. The tippy part of the hill. So on top of the house here? On top of the house would be very cute. It shouldn't be difficult to get up here, right? Anyone can do what I just did? If I can do it with 2 seconds of input lag, I think you guys can do that. Do you have any tricks up your sleeve other than just simplifying your geo? Yeah, we haven't gotten any culling yet. There's no culling yet. Non-zero. Okay, let's keep in mind the one area was 24 FPS. The top was also 24 FPS. Back to this. Okay, so... Okay, this was like here. So culling that part wouldn't help. Now for the beginning, we could absolutely cull this part and it would just fix the issue. Oh, this texture is used twice, I see. Could we conceivably use this texture here? Do you think, Marty? That would work? Who's this there? He's what's... Oh, I see. I see. Is that all of them? I think so. Okay, I think the staircase can work. I think I just need to slightly make it bigger. Okay. Yep, that looks fairly different, doesn't it? What do you think? Are we okay with that? Okay. It looks so similar that I didn't even notice at first. Wow. It seems... Oh, I see what you mean. Okay, yeah. That's a good warning. I hope I didn't need any. Okay, nice. So now we have the aqueduct textures localized entirely here. And that's... What? 800 triangles that we can cull. So the way we could do this is whenever it's not on camera, we just don't render it. You know what I mean, T-junction? T-junction are dangerous on N64 because we have relatively low vertex precision. So it often opens up holes. The house using this material is fine. Because you're never going to be able to see the staircase. And you're never going to be able to see the house without also seeing the staircase. It's too bad that FASt64 generates axis-aligned bounding boxes. If they didn't, we could just make this culled. So the way this should probably work... We need to write some sort of algorithm to decide whether the staircases should be culled or not. I'm thinking... We check the angle from the furthest point here to the camera. Like the point all the way over there. And then... If it's within a certain angle range, we just don't render it. Or actually we could also take in the rotation of... Do we need to take in the rotation of the camera? Probably not. Or we could just make a big boundary volume where if the camera is in there, it just wouldn't do this. What about the same occlusion tag that was developed and used in the pyramid level? The pyramid level? Are you talking about shifting sand lines? That level has no occlusion tag. Jungle? I don't know of a jungle pyramid. I'm kind of starting to have a short break because my wrist really hurts. I should probably take like a week off the computer, but I want to do work. Question in the chat. And sorry if I'm re-asking a question you haven't answered. But with all those textures you have, are you doing multiple reads of texture from algorithm? Or have you sorted textures you can use the same one over and over again in RDP? That's a very good question. I make very sure that each texture is only used once. So if you had joined the stream 10 minutes earlier, you would have seen that this aqueduct here, it had a texture that was shared with the walls here. And I replaced the wall texture for a very similar looking one from the staircases up here, because I was planning to cull the aqueduct. So by putting the aqueduct in a separate display list, I would have risked my texture loads existing twice. But because I have changed the texture, it will only exist once. Of course, technically, you could sort all your materials in a way where you can bleed one texture between your first mesh and your second mesh. But our tooling support is not quite there yet, unfortunately. Anyway, while I'm stalling here... What if... ...culling was a thing that is default off and you have to opt into it? And you opt into it by being within a certain sphere. The sphere would look something like... ... It's no longer a sphere, but it's close enough. Like, what if the arch was only ever culled if the camera was within this sphere right here? I think that might be a good way of handling it. And then as soon as you come around here, it stops being culled. I think that's a good way of doing it. It's very cheap. A cuboid? I don't think so. Unless we use, like, a rotated cuboid. No, it doesn't draw any polygons. It's a very cheap math formula. Twitch told me I'm trending? I have 300 viewers? What? Why do I have 300 viewers? Where did you guys come from? Does the level just look that good? Wow. Marty is drawing in the crowd. 200? Wow, I stream on YouTube and Twitch at the same time. Alright, let's mark this as cullable. It says cullable on the ceiling. It's a better joke than I thought it was when I said it at first. That joke's actually amazing. It does say cullable on the ceiling, because you no never look up. Your ceiling is very cullable. And there goes 500 viewers. I only stream on my second channel on YouTube. Because I don't want, like, a million people asking the same stupid questions over and over. There's a Yoshiko. Where is my file here? I have one file for all the code for all my side levels. There we go. Okay, so... I'm going to move this here. Give it the behavior 777777777, so I can find it. I'm going to give this the aqueduct color behavior. Why the fuck wouldn't I? That's actually... I was almost doing something stupid. Interestingly, it reposts the link to the traditional live stream when you go live. It's automated. Oh, right! I forgot about this. I have a new system. I no longer need to extern these things. Oh, that's awesome. Anyway... Let's export this. Okay, so first we need to back up the... ...the display list pointer. Well, we don't need to, but it makes my life a little easier. It actually gives us a lot more performance. Like, by, like, 0.5 microseconds. Isn't that great? And then... ...we want to store the first... ...comment here. The first... ...display list comment. Like so. Just making sure it compiles. Just making sure it compiles. Okay, that's what I thought. We need level parameters. Not image. Will this version be good or will it be hated? I have no idea. People would probably... Um, no idea. Invalid use undefined type gfx. It's not a struct, is it? It's a typedef. Okay, nice, there we go. Okay, next. On static gfx. On static gfx. Assembly equals... Let's do gfsp and display list... ...comment. Okay. Okay. So this is how we will turn the culling on and off. Oops. And next, we only need to program the hitbox. So... I know inconsistent capitalization, but this is... ...the Mario64 decompilation's fault and not my own. And then we also need this to be a scaled sphere. So I think the shortest axis is the x-axis. And 1802. Okay. You know what? We are going optimal. Why not? On N64, it's actually optimal to... ...do some shit like this. Okay. And now we need to scale the distance along each axis. Pose1.i? Nope. Oh, yes. Good catch. Okay. Don't make a stupid mistake and compile. It does not compile. Because... ...this. Then we don't need this anymore. Okay. 10802 was on x. And z is... ...12000. So... And on the last axis... 13000. Just for testing. I just realized this needs to be from the camera, not from Mario. So... I accidentally put the thing here. I accidentally exported the mesh. And it's not being culled right now. Okay. So we have two issues. Why is it not being culled? Why is the mesh there? Okay. I think we're done with the background. Go back to the observatory. And... I misspelled SQRTF. Alright. Let's see what the distance is. What do you cull? The big aqueduct. Distance zero? What? There is a game factor with someone? Yes. One of them is one on purpose. That's the smallest one. Okay. We also need to bleed separately on this one. And... Oh god. I was drawing the skybox twice. I was drawing the skybox three times. How could this possibly be zero? Oh. Because I need to cast S32. Percent F doesn't actually exist. In this dungeon. The distance is clearly less than the 10800 I put in. I actually duplicated the distance from what it needs to be. So... Wait. And this was inverted. Okay. Now it all makes sense. I think now the culling is going to be perfect. Okay. Culled? Not culled. Nice. Then as soon as I come around this corner to see the aqueduct, it's no longer culled. Do you see that? Now it's culled. Ah, you can see the pop-on though. We were a little too aggressive here. Do you see it working though? On N64 you probably wouldn't notice that. I think this might be fine. White apple? Yeah, that's a fast64 bug. Not something I can fix, unfortunately. That's a bug with the tooling. We just have to ignore that and hope that gets better eventually. I kind of want to make it bigger in this direction though. I think it should be here. And then bigger this way. Hmm. It would be nice if we could make it go all the way into the mountain. We could just be way more aggressive with it. That wouldn't be an issue. It's just that this part here... Actually, it's fine in the middle. Nevermind, we're all good. Since we had a Skybox. No, this is a culling box for the aqueduct here. Alright, let's get the sizes once more. This is 12.49. This is 12.49. 17084. By 82. And that's on this axis here. I think the Y axis is unchanged. But let me just... Do this one more time. 12432. Okay, unchanged. Alright, who's ready for another N64 test? Let's see how much we just removed lag. I am hoping for a 30fps beginning now. But I'm not confident in it. That is pretty much 30. It's not with anti-aliasing on yet. 28. Honestly, that's a 2fps improvement. For the work we did, that's not bad. Of course, this is still rough. Let's de-dither. Look at the game now. And then compare. It basically just looks like a blur filter. And it costs a little bit of performance. But I can see some people would prefer it on. Because without it, there are some dither patterns. If you look at the skybox, I think you would see it. Yeah, on the skybox you can see a little bit of a pattern, right? So, with that on, the pattern kind of disappears. I don't know why. Oh... The aqueduct problem is really bad here. I made the carbox too big. Shit. Oh, but you see how the aqueduct instantly eats 3fps? It's trivial to make the glass rotate around the map. I might do that. Let's see, I didn't pay attention to... Wait, what? Are those being called? I must have entered the things wrong. 1, 2, 5, 4, 9... Did I...? I must have not re-exported the level. Okay, yeah, I didn't re-export the level. So the box was still in the wrong position. That explains it. Okay, nevermind. False alarm. Does that change our performance profiling? It only changes the one box not appearing. So we're all good. Nothing to worry about. Okay. So. We got around 3fps in the beginning. Which is good. But it's not good enough. But there's more things we can do. I actually think this is a much bigger issue right now. The 24fps here. Why the low fps though? Chat, why is this happening? Oh. Oh my god. I thought that Grunty laugh was in my real life for a second. I thought that was... Okay, so this is rendering very early, so it's going to cause a lot of overdraw for no reason. Let's put this at the end. Is the pagoda being overdrawn? Maybe, but the pagoda is not a lot of surface area, so it's not something I'm worried about. Oh, I'm not sure when the cliffside should be drawn. Now that I think about it, that's a tough one. Because the cliffside is overdrawing everything right now, but also we kind of want it to overdraw some stuff. But if I think about all of this being overdrawn, ooh, that kind of sucks. This one might actually make sense to be split into two materials, as weird as that would be. This one is also nice to go at the end, just for minor optimization. Mwahahaha. Aren't we listening to Donkey Kong 64? Why is Gruntilda laughing in my ear right now? It's actually a little weird, no? Okay, so wouldn't it be better to calculate the distance from the center of a point instead of using actual sphere geometry? That's what we're doing, that sphere is only there as a visualization for me. Okay, river soil actually is goated overdraw-wise, because we just put this at the top and it always draws on top of something. We should move this all the way to the top. Okay, so the pagoda? The pagoda is probably causing some amount of overdraw. The floor tile? Well, actually, it's drawing relatively late. I don't think it really is a concern. And this renders after Witherback Cliff. Though I'm not worried about it. Grass with winds. This is also grass with winds. The grass is with- Ah, well, we have spotted by height first, so this shouldn't be an issue. The planks inside the pagoda roof could go- Oh, I see. I didn't even notice these. Yeah, they seem like a lot of detail that you can't see. I mean, is this 20 triangles? Oh, well. 24 triangles, wait. Why is this one separated and the other ones aren't? That's sus. Have I been sold triangles that don't do anything? Four vertex colors? I see. All the vertex colors are very similar, though. I don't think it's really worth the subdivision. I mean, these are 24 triangles, they don't really do much. This is a tough call to make, but it's not worth overthinking it. This has such a low impact. Oh, I see. Oh, okay, nevermind. Yeah, okay, I see what you mean by vertex colors. Remove every beam. Yeah, the thing is, playas don't really look up. The fact that there's one beam at all is already overkill, and I think playas will be happy about the one beam. Let's remove him. Same with the collision map. Oh, it's sprouting here, that's actually looking so cool. I didn't even see that when I made the collision. I think we haven't really hunted for triangles that are removable before. I feel like we're gonna find some visual triangles that we don't really need. I think I've seen some on these rocks here. Okay, I see why all of them are necessary. But what if we did something like just moving them in here? I think it might be the correct choice to do that. Well, but again, the rocks are such a small minor change that I don't think that's gonna make or break it. Hmm. Where else? I mean, something like that is an easy one. That's a no-hanging one. Right, no one misses these vertices today. Same here. Hello, the tether. Who are you tethering today? That one is a little more to remove, but still. These all don't look like anything. Like, they don't add enough visuals to be valuable to keep. Hmm. I guess, is it even possible to see these triangles? I think these two are literally invisible. Yeah, I think this entire strip can go. Because you can't really see it from the gameplay area. Even from up here, it's not really visible. I mean, that's only 22 triangles, but still, it's something. Hello, Diamond Yoshi. That thing needs something to make Mark 64 a kazoon. I mean, case. Sorry, game devs with kazoo names. They should add 10,000 lines of code to one function already remembered and do a reframe. Sure. To hide the gap between the trees and the ground. I see. But that's already hidden by the bush anyway, from like, for this thing. I can see an argument for like these strips to exist because they transition to colors nicely. And you can actually kind of see it if they're like up here. That's a few triangles removed. The leaf for Pikmin was one-sided and turned off culling. I made it have double sides and turned on culling. Don't know if this is worse or better. That's worse. This could technically also be culled with the aqueduct. But it's not really worth it. And okay, this one actually, there's a lot of culling potential here. What happened to my Donkey Kong music? Sorry, this is an important thing. Ah, just the playtester messaging me. So, what we can do here, we can make this all part of the same culling, as long as it's only using the one texture. But everything that's being used by multiple textures, we can't really do that. What the hell? Okay, let's see. Well, he's reusing his textures a lot, which is a good thing, but that makes culling kind of difficult. We have duplicated some materials. No, no, no, the whole point of this is to remove duplicated materials, or to remove texture loads. So if you duplicate a material to remove this, we are doing the opposite of what we want. So, are there any other materials here that are unique? No? But this is a fair few unique materials that we can all get culling. What about this? Oh no, that's definitely not unique. The biggest section of the telescope? This one? That looks... No, it's used here. Must have been added pretty late. Or this one? Ah, that is unique, nice. And the lens, of course, the lens. All right, let's mark this culled. All right, we should do one more test, but what we can also look into next is occlusion planes. Because I'm thinking we have one occlusion plane here, and that's going to be at the place that is going to be the laggiest place at the end. Yes, there's a few places where using assembly right now is pretty much necessary for N64 optimization, because the current compilers we have are just not good enough. You know, like the bell curve meme where there's a really stupid guy and he says one thing and he says like use assembly to optimize and then there's a guy in the middle and he would say like no the compiler is going to write better assembly code then you don't use the compiler to optimize and then like there's a guy all the way on the right who's like yeah sometimes the compiler writes bad code you need to optimize yourself. It's kind of like that, because there's a lot of times where someone's like you need to use assembly to optimize it and then you look at the handwritten assembly and it's like the compiler would have been around 30% faster here. That happens if you look at any libultra codes or the code in Diddy Kong Racing. Okay, 30, almost, 28, 25. And the apple is red. I would like to point out that the apple is red. And this is with anti-aliasing, mind you. Most Mario 64 mods turn anti-aliasing off, because it's a very expensive effect. It's also at unlimited fps, which costs a few extra fps compared to not unlimiting them, ironically enough. I heard Diddy Kong Racing would be better, but using a modern x86 on MIPS, I think we are stuck with what has been made at that time. No, there's still compile optimizations made for GCC that like also apply to old architectures, but it's usually like linear scale improvements. Okay, we're 25 here. I think that is a mild improvement. I think it was like 24 before, so we did do something. Now, okay, you guys maybe have heard of occlusion planes when I've talked about them before. These are ones that Sauron basically invented. You can put them in the level, the game is programmed to pick the best one, and then it culls all the geometry behind it, if it's fully behind it. Now, the question is, which planes do we actually want to use? If we look at this, there just isn't that much behind it. I guess there's plants here, veggies, we can try it. This looks like Mario 64 on the PSP, what? I believe that's what the jungle pyramid is. What is jungle pyramid? Which way around do they go again? Clockwise or counterclockwise? Why didn't I write down whether they go clockwise or counterclockwise? I'm just gonna look. I don't want to fail this. That's the jungle thing you're talking about, I guess it's a temple. What are you talking about? Am I being trolled? This feels like an I think you should leave bit. Okay, they go clockwise. You're an engineer in general, could be for making and treasure games of the environment. Windows Notepad or HxD. HxD is great. I love HxD and all its flaws. Anyway, there's a cave inside here, so what is when you actually have to go like this even? That's a small plane. That's such a niche-calling plane. A few places are going to benefit from that. That's sad. I guess it's going to kill the foxes at least. Got five five six. I have ad set as low as possible. I'm innocent on this, I'm a bystander. So B3-3 went without the drama. If it's without the drama, it's not a real beta hack. Why would I play it if there's no drama attached to it? Please give me the drama, what's the point? The spline colors to the everything behind it are the only object to choose. Everything. It's per triangle. It's a microcode feature. Now the thing is, the camera is going to be like this, so it doesn't really count shit, does it? I think I'm using this completely wrong. Yeah, that's bad. We don't want it there. So now this way it at least counts the foxes. So it poking out just a little bit there is fine. Okay nice, I think it counts the whole garden now for the longest view. That's what we want. Are you cheating? Cheating on what? Can you only have one plane? You can have multiple planes in a level, but it can only pick one plane. A plane is defined by four poplar number vertices. The way it works is you just place three with circular view params like that, 0, 1, 2, and 3, and then they will build a plane, and then after the level is loaded the plane exists and the game picks the best plane every frame. So this actually also has minor benefits from the starting area, as you can see, because it was still colourful there. So I'm feeling very optimistic about this test now, unless I somehow bugged out the culling plane. Okay, 28-ish. Ah, and that was a 25 there, that's ugly. But at least this is not during a platforming section, so I don't fully hate it. Oh, that was a 26 there. I should limit FPS just so I have a more consistent frame rate here. Let's go to what was the lightest view before. Shadows are big, the new cliffs are not. Oh, I see. Okay, nice, we have 26 now, that's another two FPS gains. Well, one and a half. Nice! How does the culling wall work? You submit a plane with specific plane coefficients to the microcode, and the microcode, when it is time to draw triangles, it looks at your culling plane and it checks whether that triangle is entirely occluded by the culling plane there, the occlusion plane. So it is something akin to occlusion culling, but it is per triangle. So I don't think there is a modern analog to this. This is like a fucked up technique from the N64 realm that you would not see on a different console, that wasn't even developed back when the N64 was developed. So this is like a technique that I don't think exists literally anywhere else in the world. It is just on the N64. Antiportal is a good word to put it. Who coded that? Sauron! We are using Sauron's microcode, f3dx3, which has some new features like a bigger vertex buffer, a lot less cycles, the anti-plane there, ambient occlusion, shade and vertex color at the same time. It is actually crazy how much better f3dx3 is compared to f3dx2, given that there were professional developers being paid accumulative millions of dollars to make those, and then Sauron just comes along and makes it way better. He would be very humble about it though, he would say something like, oh I am standing on the shoulders of giants, couldn't have done this without their help, but really I think he could have. Does UNO give us what f3dx3? Yes it does. For the original f3dx2 microcode that Nintendo used, I am sure there were millions put into that, right? Considering how many games were made with it, surely they put a lot of money into it. Oh my god, that is actually so chill at the sunset here. Oh yeah, before I forget, we should add a sunset. Where is the sun? Over here. Am I stupid? Where is it? Right there? Okay, so it is coming exactly from the bottom right. Let me print the current level ID, just to be sure. It should be one. It should be one, but I want to be 100% certain before I waste my time. Can we get some sweet lands flow? Sure. It is two. Okay, that makes sense. Fair enough. Switch slides. Okay, so we want a very strong sun. Probably with harsh shadows, given how dark the level is in the dark parts. And we want it to come from a direction that is like... What is the direction? Like 803080? No, no, no, no, that is bullshit. 660, right? 96 multiplied by 96 plus 96 multiplied by 96 plus 30 multiplied by 30. Compared to 127, that is too high. 87, so I am doing some math on my second screen right now. You can't see it. 88. 88 is too high. Okay, let me do 87. 87, 30, 87. 1012. The light might be mirrored right now, but it will only take a few tries to figure this out properly. Yo, nice GTM. Welcome to the stream. Okay, we got the lighting direction exactly perfect the first time around. How do you like this level, GTM? We were optimizing this for the N64 earlier. What do you think? Do we want a different color for the light? We could make the light a little orange. A bit stronger. It's literally set to 255. I also feel like the sun would be more orange. Hail to Dodongo actually made an HDR implementation. That's cool looking. I think I like the sun. It seems right to me. There was something else I originally wanted to do. What was the other thing? We now have the sun. What's the other thing? Yes, oh, the lens flare. Oh yeah, I'm aware that it's very tempting to overdo visual effects, so I hold myself back on purpose. There's a general tendency that if you program a cool effect, you want the player to really notice it, and then you just crank it up to 11 for no reason. Okay, so plus plus minus. No, plus plus plus. Yes, plus plus plus, okay. This setup sucks. I don't like that I have to increment that value there. Four. Why am I editing lens flare six here? What? I don't know, I'm on grass. This, uh, okay. Warning, this orange, that's not well, what is this? Oh, because I removed two, makes sense. Okay. So now we need to define the position of the lens flare. We're going to move it exactly where the sun is. Change the OSD, please. No. Materials are only a complex multi-texture. I see this. Okay, I see. So, I'll just take these, make it 10 times as far away. All right, now we should have a lens flare, unless I broke the lens flares. I will say, guys, I refactor my engine, like, a lot, and there is a good chance that I break all the features, because I'm kind of reckless with it, because I don't value having the Ultra Mark 64 source code intact at all, but sometimes that also breaks my own code. Well, I do see a lens flare. Oh, I see. Okay, so the lens flare is there, but it's a little on the nose. And now it's not there. What the fuck? Oh, it's blocked by collision, and we have the huge fake collision walls. That's why it's like that. Okay, we need to find a different solution to make players not go over here. It will not be an issue. That's fine. There's no surface below there, so you can't jump into it anyway. Now, the problem remains that at the beginning, you were kind of able to just go there, and you were just getting the sun in your face. I guess that's going to be solved once we make a collision map. Never mind, I'm not worried about it. Yes, this will be part of RTY HDM. It needs a special collision material that does not block lens flare. I don't like putting special features into the engine directly like that. You should always try to find a way to make your thing work that doesn't involve processing costs literally everywhere else. So we'll just make the collision map properly block that part of the sun as well. Right now, I'm pretty sure that this here just doesn't have collision. Oh, maybe it does have collision. Well, something's wrong with the collision. Dariel's maps always look like they're made of clay. They're all so shiny. You ever seen that Japanese polished mud ball? That's kind of what their levels remind me of. It's the same as Waltz, but I remember those don't really exist. Yeah. It's a little ugly that the hills come up with you this much. How's the sun not blocked here? I think there are some bugs because I made this go so far. I think if I reduce this, it will work a little better. What is the last one anyway? I think we could reduce the lens flare intensity. I hope this egg will be better than Monstrous Banners. Why the random shade at Mr. Comet? What did Mr. Comet do to you? Meow, meow, meow, meow, meow, meow, meow, meow, meow, meow. I think that's a bit better, it not being so intense. I think maybe I put the intensity too low. Maybe not, I actually kind of like it. Meow, meow, meow, meow, meow, meow, meow, meow, meow. I have a worm in my brain, I'm sorry. Meow, meow, meow, meow, meow, meow, meow, meow, meow, meow. Did we notice we're only at 64? I think so, but this is I think a good amount. All right, we got the level mostly like this now. There will be a lot of optimization through removing unnecessary collision triangles. So I will say I expect at least another 1 FPS improvement in that spot, just because the collision will be less foggy. And also the apples here will be a separate actor. So that's going to help too, because they're going to be culled in the luckiest setting. And while I go over all the small collision improvements, I'm sure I'll find a couple more triangles that can be removed all over the place. So I think it is completely reasonable that the laggy part there that was 26 FPS is going to hit 30 in final. Mario's too dark? Dang. I tried so hard to get the sun right, but maybe it is too dark. It looks good, but I get that playability is also a factor we have to consider. Thinking about what else we could remove... I really like this section here. This section is so useless. But I like it. It's like you can go there, but there's no reason to. But you can. But I might go over this level as well. I don't know. I don't think it's necessary. I will say this one section here, the... This edge here is kind of weird. It like violates the rule of every cliff needs to change the texture. But it's probably fine. It just looks so... bald. We also still need to program the maze. The maze is going to be a little different, and that might actually also be removed. And this is a stupid thing to do. Why is this happening? Which function even is this? Is it root4, 8, 1, 8, 0? Finish move? Ah, we're landing like in an enveloped position somehow. Interesting. Do you have mechanic? I assume the old is really hard to make. The overworld takes really long now. It is like the main part of the game. But also there is a factor of I now have a child, and I have a job now. And that also slows me down a lot. Yeah, I feel like I'm done for today. I think we've made good progress importing Marty's level. We now need enemies. Marty, you wanted to make the enemies too, right? I think it's a good place to put it on hold until we have the enemies. And then once we have the enemies and everything, we'll finish up the level. So, we redesigned the two guys we figured out. Starting in a few days. Awesome. Okay, I will hold off on that then. And we have the leveling game. Actually, I want to check the ROM size real quick before we cancel the stream. How much did that add to the size? 62.2 megabytes. So we're still in budget. We can go to 64 megabytes, but it's getting pretty close. There's still a few more saves, but it's getting close. Yeah, so until next stream. Bye-bye.
